import{_ as R}from"./DbRmwbl4.js";import{_ as L,a as M,b as q,c as z,d as E,e as J,f as K,g as P,h as Q,i as W,j as X,k as Y,l as Z,m as h}from"./Bk-8HdKD.js";import{_ as ee,a as le}from"./xG5u76J_.js";import{_ as te,a as ne,b as oe,c as se,d as ae}from"./DkIjAwkr.js";import{_ as ue}from"./tCog_cYv.js";import{d as B,r as U,O as re,t as f,v as g,x as i,z as e,A as t,B as o,D as s,a as me,u as _e,o as ie,G as de,y as V,H as fe,I as pe,J as ce}from"./CE95Wurm.js";import{u as Ue}from"./C5GjP6W8.js";const ge={class:"flex flex-col gap-3"},ve=B({__name:"UserForm",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(C,{emit:b}){const d=C,v=b,u=U({username:d.modelValue.username||"",user_full_name:d.modelValue.user_full_name||"",role:d.modelValue.role||"user",telegram_id:d.modelValue.telegram_id||""});return re(u,p=>{v("update:modelValue",p)},{deep:!0}),(p,n)=>{const m=ee,$=le,k=te,r=ne,l=oe,c=ue,D=se,T=ae;return f(),g("div",ge,[i("div",null,[e(m,{for:"username"},{default:t(()=>n[4]||(n[4]=[o("Имя")])),_:1}),e($,{class:"mt-2",id:"username",modelValue:s(u).username,"onUpdate:modelValue":n[0]||(n[0]=_=>s(u).username=_),placeholder:"Введите имя"},null,8,["modelValue"])]),i("div",null,[e(m,{for:"user_full_name"},{default:t(()=>n[5]||(n[5]=[o("Фамилия")])),_:1}),e($,{class:"mt-2",id:"user_full_name",modelValue:s(u).user_full_name,"onUpdate:modelValue":n[1]||(n[1]=_=>s(u).user_full_name=_),placeholder:"Введите фамилию"},null,8,["modelValue"])]),i("div",null,[e(m,{for:"role"},{default:t(()=>n[6]||(n[6]=[o("Роль")])),_:1}),e(T,{modelValue:s(u).role,"onUpdate:modelValue":n[2]||(n[2]=_=>s(u).role=_)},{default:t(()=>[e(r,null,{default:t(()=>[e(k,{placeholder:"Выберите роль"})]),_:1}),e(D,null,{default:t(()=>[e(c,null,{default:t(()=>[e(l,{value:"admin"},{default:t(()=>n[7]||(n[7]=[o("Администратор")])),_:1}),e(l,{value:"user"},{default:t(()=>n[8]||(n[8]=[o("Пользователь")])),_:1}),e(l,{value:"subcontracter"},{default:t(()=>n[9]||(n[9]=[o("Подрядчик")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",null,[e(m,{for:"telegram_id"},{default:t(()=>n[10]||(n[10]=[o("TG ID")])),_:1}),e($,{class:"mt-2",id:"telegram_id",modelValue:s(u).telegram_id,"onUpdate:modelValue":n[3]||(n[3]=_=>s(u).telegram_id=_),placeholder:"Введите TG ID"},null,8,["modelValue"])])])}}}),$e={class:"p-6"},Ve={class:"flex gap-2 mb-4"},be={class:"flex justify-between w-full"},xe={key:0,class:"text-center"},ye={key:1,class:"text-red-500 text-center"},ke={key:2},Ge=B({__name:"index",setup(C){const{$useApi:b}=me(),d=_e();Ue({title:"Пользователи"});const v=U([]),u=U(!0),p=U(null),n=U(!1),m=U({user_full_name:"",username:"",role:"",telegram_id:""}),$=async()=>{try{const{data:r}=await b.get("/users/");v.value=r}catch(r){p.value=r.message}finally{u.value=!1}},k=async()=>{try{const{data:r}=await b.post("/users/",m.value);v.value.push(r),n.value=!1,m.value={user_full_name:"",username:"",role:"",telegram_id:""}}catch(r){console.error("Ошибка создания пользователя:",r)}};return ie($),(r,l)=>{const c=R,D=L,T=M,_=q,S=z,I=ve,F=E,G=J,H=K,j=P,x=Q,w=W,N=X,y=Y,A=Z,O=h;return f(),g("div",$e,[l[16]||(l[16]=i("h1",{class:"text-2xl font-bold mb-4"},"Список пользователей",-1)),i("div",Ve,[e(c,{onClick:l[0]||(l[0]=a=>s(d).push("/")),class:"h-8 w-8"},{default:t(()=>l[5]||(l[5]=[o(" < ")])),_:1}),e(H,{open:s(n),"onUpdate:open":l[4]||(l[4]=a=>de(n)?n.value=a:null)},{default:t(()=>[e(D,{"as-child":""},{default:t(()=>[e(c,{onClick:l[1]||(l[1]=a=>n.value=!0),class:"h-8 w-8"},{default:t(()=>l[6]||(l[6]=[o(" + ")])),_:1})]),_:1}),e(G,null,{default:t(()=>[e(S,null,{default:t(()=>[e(T,null,{default:t(()=>l[7]||(l[7]=[o("Создать пользователя")])),_:1}),e(_)]),_:1}),e(I,{"model-value":s(m),"onUpdate:modelValue":l[2]||(l[2]=a=>m.value=a)},null,8,["model-value"]),e(F,null,{default:t(()=>[i("div",be,[e(c,{class:"mb-2",onClick:l[3]||(l[3]=a=>n.value=!1)},{default:t(()=>l[8]||(l[8]=[o("Отмена")])),_:1}),e(c,{onClick:k},{default:t(()=>l[9]||(l[9]=[o("Создать")])),_:1})])]),_:1})]),_:1})]),_:1},8,["open"])]),s(u)?(f(),g("div",xe,l[10]||(l[10]=[i("p",null,"Загрузка...",-1)]))):s(p)?(f(),g("div",ye,[i("p",null,"Ошибка загрузки: "+V(s(p)),1)])):(f(),g("div",ke,[e(O,null,{default:t(()=>[e(j,null,{default:t(()=>l[11]||(l[11]=[o("Список пользователей.")])),_:1}),e(N,{class:"bg-slate-100"},{default:t(()=>[e(w,null,{default:t(()=>[e(x,null,{default:t(()=>l[12]||(l[12]=[o("Имя")])),_:1}),e(x,null,{default:t(()=>l[13]||(l[13]=[o("Фамилия")])),_:1}),e(x,null,{default:t(()=>l[14]||(l[14]=[o("Роль")])),_:1}),e(x,null,{default:t(()=>l[15]||(l[15]=[o("TG ID")])),_:1})]),_:1})]),_:1}),e(A,null,{default:t(()=>[(f(!0),g(fe,null,pe(s(v),a=>(f(),ce(w,{key:a.id,onClick:De=>s(d).push(`/users/${a.id}`),class:"cursor-pointer hover:bg-gray-100"},{default:t(()=>[e(y,null,{default:t(()=>[o(V(a.username),1)]),_:2},1024),e(y,null,{default:t(()=>[o(V(a.user_full_name),1)]),_:2},1024),e(y,null,{default:t(()=>[o(V(a.role),1)]),_:2},1024),e(y,null,{default:t(()=>[o(V(a.telegram_id),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]))])}}});export{Ge as default};
